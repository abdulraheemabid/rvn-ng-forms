<div class="container" *ngIf="initDone">

    <div class="attributes">
        <div class="heading">
            <h1>Attributes</h1>
            <rvn-divider></rvn-divider>
        </div>

        <rvn-accordion class="accordion">
            <rvn-accordion-panel>
                <span title class="title">
                    <span>
                        Form Name:
                        <span class="text-bold">
                            <span *ngIf="formNameCtrl?.value">{{formNameCtrl.value}}</span>
                            <span *ngIf="!formNameCtrl?.value" class="warn-color">Not Specified</span>
                        </span>
                    </span>
                </span>
                <rvn-input content class="form-name" [params]="formNameCompParam" [formControl]="formNameCtrl">
                </rvn-input>
            </rvn-accordion-panel>
        </rvn-accordion>
    </div>

    <div class="fields">

        <div class="heading background-bg">
            <div class="flex">
                <h1>
                    Fields
                    <span class="total text-caption">(total: {{fieldGroups.controls.length}})</span>
                </h1>
                <div class="btns">
                    <rvn-button (click)="expandAllFields()" class="add-field-btn" [params]="expandCompParam">Expand
                    </rvn-button>
                    <rvn-button (click)="collapseAllFields()" class="add-field-btn" [params]="collapseCompParam">
                        Collapse
                    </rvn-button>
                    <rvn-button (click)="addField()" class="add-field-btn" [params]="fieldAddCompParam">New Field
                    </rvn-button>
                </div>
            </div>
            <rvn-divider></rvn-divider>
        </div>



        <rvn-accordion #accordion class="accordion" cdkDropList (cdkDropListDropped)="changePositionOfField($event)">

            <rvn-accordion-panel cdkDrag class="field"
                [params]="{hasActionContent: true, expanded: field.get('attributes')?.get('_expanded').value}"
                *ngFor="let field of fieldGroups.controls; let i = index; let last = last; let first = first">

                <span title class="title" [ngClass]="{'warn-color': validated && field.status === 'INVALID' && field.dirty}">
                    <span>
                        Field Position:
                        <span class="text-bold">{{i+1}}</span>
                    </span>

                    <span *ngIf="field.get('name')?.value">
                        Name:
                        <span class="text-bold">{{field.get('name')?.value}}</span>
                    </span>

                    <span *ngIf="field.get('type')?.value">
                        Type:
                        <span class="text-bold">{{field.get('type')?.value?.value}}</span>
                    </span>

                    <span *ngIf="validated && field.status === 'INVALID' && field.dirty" class="text-bold">INVALID</span>
                    
                </span>


                <field-definition content [fieldFG]="field"></field-definition>

                <rvn-button actionContent (click)="deleteField(i)" [params]="deleteFieldCompParam"
                    [disabled]="first && last">
                    Delete</rvn-button>

            </rvn-accordion-panel>

        </rvn-accordion>

    </div>